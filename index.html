<html>
  <head>
    <style>
      .wrapped {
        overflow-wrap: break-word;
      }
    </style>
    <script src="big-number.js"></script>
    <script>
      const number = localStorage.getItem("num") ? BigNumber.retrieve(localStorage.getItem("num")) : new BigNumber();
      if (number.chunks === 1 && number.head.value <= 1) {
        number.head.value = 2;
      }
      
      function iterate() {
        
        const n = number.copy();
        do {
          n.apply3n1();
          const comp = number.compare(n);
          if (comp === 0) {
              if (n.chunks === 1 && (n.head.value === 1 || n.head.value === 2 || n.head.value === 4) {
                  break;
              }
              console.log("cycle:", number.toString());
              return true;
          } else if (comp < 0) {
              break;
          }
        } while(true);
        number.increment();
        
        document.getElementById("increment-div").textContent = number.toString();
      }
      
      function loop() {
        if (!iterate()) {
          requestAnimationFrame(loop);
        }
      }
      
      document.addEventListener("DOMContentLoaded", () => {
        loop(0);
      });
    </script>
  </head>

  <body>
    <div class="wrapped" id="increment-div"></div>
    
  </body>
</html>
