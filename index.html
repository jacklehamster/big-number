<html>
  <head>
    <style>
      .wrapped {
        overflow-wrap: break-word;
      }
    </style>
    <script src="big-number.js"></script>
    <script>
      const num2exp68 = new BigNumber();
      num2exp68.head.value = 1;
      for (let i = 0; i < 68; i++) {
        num2exp68.mul(2);
      }
      
      let number = localStorage.getItem("num") ? BigNumber.retrieve(localStorage.getItem("num")) : new BigNumber();
      let n;
      if (number.chunks === 1 && number.head.value <= 1) {
        number.head.value = 2;
      }
      if (number.compare(num2exp68) > 0) {
        number = num2exp68;
      }
      
      function iterate() {
        if (!n) {
          n = number.copy();
        }
        n.apply3n1();
        const comp = number.compare(n);
        if (comp === 0) {
            if (n.chunks === 1 && (n.head.value === 1 || n.head.value === 2 || n.head.value === 4)) {
                nextNumber(number);
                return false;
            }
            console.log("Number:", number.toString(), ". n:", n.toString());
            console.log("cycle:", number.toString());
            return true;
        } else if (comp < 0) {
            nextNumber(number);
            n = null;
            return false;
        } else {
            return false;
        }
      }
      
      function nextNumber(number) {
        if (number.even()) {
          number.increment();
        } else {
          number.increment(2);
        }
      }
      
      function loop() {
        const start = performance.now();
        while(performance.now() - start < 30) {
          if (iterate()) {
            return;
          }
        }
        const numString = number.toString();
        localStorage.setItem("num", numString);
        document.getElementById("increment-div").textContent = numString;
        document.getElementById("increment-div-calc").textContent = n === null ? "" : n.toString();
        document.getElementById("date").textContent = (new Date()).toString();
        document.getElementById("max-num").textContent = numString;
        requestAnimationFrame(loop);
      }
      
      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("increment-div").textContent = number.toString();
        loop(0);
      });
    </script>
  </head>

  <body>
    <div class="wrapped" id="increment-div"></div>
    <br>
    <div class="wrapped" id="increment-div-calc"></div>
    <br>
    <br>
    
    According to Google:
    <a href="https://www.google.com/search?q=collatz+conjecture+highest+number&sxsrf=ALeKk03G0rqrPkOPmAyjIVC6sGrbOGNnvA%3A1629103622784&source=hp&ei=BiYaYY-NLZHs9AOp0ayYBw&iflsig=AINFCbYAAAAAYRo0FgRXfdPf62svCMnFWQKofOtN_Nnq&oq=coll&gs_lcp=Cgdnd3Mtd2l6EAMYADIECCMQJzIFCAAQkQIyBQgAEJECMg4ILhCABBCxAxDHARDRAzIFCC4QgAQyBQgAEIAEMggIABCABBCxAzIICAAQgAQQsQMyCAguEIAEELEDMgsIABCABBCxAxCDAToHCCMQ6gIQJzoOCC4QgAQQsQMQxwEQowI6EQguEIAEELEDEIMBEMcBENEDOggILhCxAxCDAToLCC4QgAQQxwEQ0QNQ8xJY7hhg1yFoAXAAeACAAYgDiAGrBpIBBzAuMy4wLjGYAQCgAQGwAQo&sclient=gws-wiz">
      As of 2020, the Collatz conjecture has been checked by computer for all starting values up to 2<sup>68</sup> ≈ 2.95×10<sup>20</sup>. All initial values tested so far eventually end in the repeating cycle (4;2;1) of period 3.
    </a>
    <br>
    <br>
    <div  class="wrapped">
      This page was made just to break that record. As of <div id="date"></div>
      the conjecture has been checked up to <span id="max-num"></span> which is higher than 2<sup>68</sup>.
    </div>
    
    
  </body>
</html>
